realInput = (cell2mat(struct2cell(load('C:/Users/magshimim/Desktop/DPD/DPD/pa_data/input.mat'))));
output = transpose(cell2mat(struct2cell(load('output.mat'))));
o = output(1,:)+(1i)*output(2,:);
scale_factor = max(realInput)/(max(o));
scaled_output = o*scale_factor;

DPDinput = transpose(create_matrix(scaled_output));
DPDouput = transpose([transpose(real(realInput)), transpose(imag(realInput))]);

netDPD = feedforwardnet([22 40 2],'trainbr');
netDPD=train(netDPD,DPDinput,DPDouput);
%%%


realInput = (cell2mat(struct2cell(load('C:/Users/magshimim/Desktop/DPD/DPD/pa_data/input.mat'))));
output = transpose(cell2mat(struct2cell(load('output.mat'))));
o = output(1,:)+(1i)*output(2,:);
scale_factor = max(realInput)/(max(o));
scaled_output = o*scale_factor;
r = real(scaled_output);
I = imag(scaled_output);
DPDinput = zeros(length(realInput)*2,1);
DPDinput = transpose(abs(scaled_output));
DPDouput = transpose(abs(realInput));

netDPD = feedforwardnet([10500],'trainbr');
netDPD=train(netDPD,DPDinput,DPDouput);




